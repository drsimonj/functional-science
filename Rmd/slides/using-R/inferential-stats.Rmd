---
title: "Using R: Inferential Statistics"
author: "Simon A Jackson"
date: "Knit on `r format(Sys.time(), '%d %B, %Y')`"
output: ioslides_presentation
---

```{r setup, echo = F, warning = F}
require(knitr, quietly = TRUE)
opts_knit$set(root.dir = '../../../')
```

# Setup

## Packages

We'll make use of the `tidyr` package.

Make sure it's installed on you system and then load it into your workspace.

```{r, eval = F}
install.packages("tidyr")  # Only if not installed yet
```
```{r, warning = F}
library(tidyr)  # load it into your workspace
```

## Our Data Set

Let's read in the risk data to practice.

```{r}
d <- read.csv("data/risk.csv")
head(d)
```

## Our Data Set

Convert relevant variables to factors.

```{r, results = "hide"}
d$subid <- factor(d$subid)

d$gender <- factor(d$gender, levels = c(0, 1),
                   labels = c("female", "male"))

d$wvcat <- factor(d$wvcat, levels = c(0, 1, 2, 3),
                  labels = c("Unclassifiable", "Individualist", 
                             "Hierarchicalist", "Egalitarian"))
```

# t.test()

## One Sample

One sample *t* test for a null hypothesis.  
Default settings: null = 0; significance level = .05

```{r}
t.test(d$risk)
```

## Independent Samples (Between)

`t.test(dv ~ group)`

```{r}
t.test(d$risk ~ d$gender)  # t.test(risk ~ gender, data = d)
```

## Paired Samples (Within)

Let's adjust our data a bit...

```{r}
x <- d[d$active == "STK80" | d$active == "STK20",
       c("subid", "risk", "active")]
wd <- spread(x, active, risk)  # Wide Data set
head(wd)
```

## Paired Samples (Within)

`t.test(var1, var2, paired = TRUE)`

```{r}
t.test(wd$STK80, wd$STK20, paired = TRUE)
```

# Statistical Modelling in `R`

## Two-step Process

In general, statistical modelling in R takes two steps.

1. Define and fit your model.
2. Examine the results.

## Defining the Model: The Tilde `~`

In general, statistical models are of the form  
`explain variance in Y with X1, X2, ... Xn`

This is done is `R` using formulas of the form  
`Y ~ X1 + X2 ... Xn`.

Our outcome variable appears to the left of the tilde (`~`) and our predictors appear to the right.

## Defining the Model: Combining Predictors

The predictors can be combined in a number of ways. Here are some common operations:

`Y ~ X1 + X2`  
Predict Y with X1 and X2

`Y ~ X1:X2`  
Predict Y with the interaction of X1 and X2

`Y ~ X1 + X2 + X1:X2` OR `Y ~ X1*X2`  
Predict Y with X1, X2, and their interaction.

# ANOVA - aov()

## One Way (Between)

```{r}
# Read in our data set
d <- read.csv("data/planes.csv")

# 1. Fit the model
fit <- aov(Distance ~ Paper, data = d)

# 2. Explore the results
summary(fit)
```

## Two-or-More Way (Between)

```{r}
# Read in our data set
d <- read.csv("data/fishing.csv")

# 1. Fit the model
fit <- aov(distance ~ rod*line*sinker, data = d)

# 2. Explore the results
summary(fit)
```

## Two-or-More Way (Between)

```{r}
# Two-variable plot
plot(d$sinker, d$distance)
```

## Two-or-More Way (Between)

```{r}
# Three-variable plot
interaction.plot(d$line, d$sinker, d$distance)
```

## Within Subjects

## Mixed

# Correlation

# Regression - lm()

## Simple Linear Regression

## Multiple Regression

## Hierarchical Regression

## Logistic Regression

## Standardized Coefficients




